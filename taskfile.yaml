version: "3"

includes:
  brew:
    taskfile: ./brew
    dir: ./brew
  git:
    taskfile: ./git
    dir: ./git
  tmux:
    taskfile: ./tmux
    dir: ./tmux
  zsh:
    taskfile: ./zsh
    dir: ./zsh

vars:
  TARGET: git tmux zsh

tasks:
  deploy:
    cmds:
      - task brew:deploy
      - for: { var: TARGET }
        cmd: task {{.ITEM}}:deploy

  clean:
    cmds:
      - for: { var: TARGET }
        cmd: task {{.ITEM}}:clean
      - task brew:clean

  deploy-new:
    vars:
      config_dir: $HOME/.config
      target_dir: nvim,ghostty,wezterm,starship,mise,sheldon
    cmds:
      - for: { var: target_dir, split: ','}
        cmd: ln -svi $(pwd)/{{.ITEM}} {{.config_dir}}

  clean-new:
    vars:
      config_dir: $HOME/.config
      target_dir: nvim,ghostty,wezterm,starship,mise,sheldon
    cmds:
      - for: { var: target_dir, split: ',' }
        cmd: unlink {{.config_dir}}/{{.ITEM}}
