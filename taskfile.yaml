version: '3'

vars:
  config_dir: $HOME/.config

tasks:
  default:
    silent: true
    cmds:
      - task --list

  deploy:
    desc: Deploy dotfiles.
    cmds:
      # Template
      # - task: deploy:{name}
      - task: deploy:brew
      - task: deploy:espanso
      - task: deploy:editorconfig
      - task: deploy:ghostty
      - task: deploy:git
      - task: deploy:mise
      - task: deploy:nvim
      - task: deploy:sheldon
      - task: deploy:starship
      - task: deploy:tmux
      - task: deploy:wezterm
      - task: deploy:zellij
      - task: deploy:zsh

  clean:
    desc: Clean dotfiles.
    cmds:
      # Template
      # - task: clean:{name}
      - task: clean:brew
      - task: clean:espanso
      - task: clean:editorconfig
      - task: clean:ghostty
      - task: clean:git
      - task: clean:mise
      - task: clean:nvim
      - task: clean:sheldon
      - task: clean:starship
      - task: clean:tmux
      - task: clean:wezterm
      - task: clean:zellij
      - task: clean:zsh

# Template
# # {name}
#   deploy:{name}:
#     desc: Deploy {name} config.
#     cmds:
#       - task: link
#         vars: { target: '{name}' }
#
#   clean:{name}:
#     desc: Clean {name} config.
#     cmds:
#       - task: unlink
#         vars: { target: '{name}' }

# brew
  deploy:brew:
    desc: Deploy brew config.
    cmds:
      - ln -svi $(pwd)/brew/.brewfile $HOME/.brewfile

  clean:brew:
    desc: Clean brew config.
    cmds:
      - unlink $HOME/.brewfile

  init:brew:
    desc: Install and upgrade all dependencies from the brew config.
    cmds:
      - brew bundle --file=$HOME/.brewfile

# espanso
  deploy:espanso:
    desc: Deploy espanso config.
    cmds:
      - task: link
        vars: { target: 'espanso' }

  clean:espanso:
    desc: Clean espanso config.
    cmds:
      - task: unlink
        vars: { target: 'espanso' }

# editorconfig
  deploy:editorconfig:
    desc: Deploy editorconfig.
    cmds:
      - task: link
        vars: { target: '.editorconfig' }

  clean:editorconfig:
    desc: Clean editorconfig.
    cmds:
      - task: unlink
        vars: { target: '.editorconfig' }

# ghostty
  deploy:ghostty:
    desc: Deploy ghostty config.
    cmds:
      - task: link
        vars: { target: 'ghostty' }

  clean:ghostty:
    desc: Clean ghostty config.
    cmds:
      - task: unlink
        vars: { target: 'ghostty' }

# git
  deploy:git:
    desc: Deploy git config.
    cmds:
      - task: link
        vars: { target: 'git' }

  clean:git:
    desc: Clean git config.
    cmds:
      - task: unlink
        vars: { target: 'git' }

# mise
  deploy:mise:
    desc: Deploy mise config.
    cmds:
      - task: link
        vars: { target: 'mise' }

  clean:mise:
    desc: Clean mise config.
    cmds:
      - task: unlink
        vars: { target: 'mise' }

# nvim
  deploy:nvim:
    desc: Deploy nvim config.
    cmds:
      - task: link
        vars: { target: 'nvim' }

  clean:nvim:
    desc: Clean nvim config.
    cmds:
      - task: unlink
        vars: { target: 'nvim' }

# sheldon
  deploy:sheldon:
    desc: Deploy sheldon config.
    cmds:
      - task: link
        vars: { target: 'sheldon' }

  clean:sheldon:
    desc: Clean sheldon config.
    cmds:
      - task: unlink
        vars: { target: 'sheldon' }

# starship
  deploy:starship:
    desc: Deploy starship config.
    cmds:
      - task: link
        vars: { target: 'starship' }

  clean:starship:
    desc: Clean starship config.
    cmds:
      - task: unlink
        vars: { target: 'starship' }

# tmux
  deploy:tmux:
    desc: Deploy tmux config.
    cmds:
      - task: link
        vars: { target: 'tmux' }

  clean:tmux:
    desc: Clean tmux config.
    cmds:
      - task: unlink
        vars: { target: 'tmux' }

# wezterm
  deploy:wezterm:
    desc: Deploy wezterm config.
    cmds:
      - task: link
        vars: { target: 'wezterm' }

  clean:wezterm:
    desc: Clean wezterm config.
    cmds:
      - task: unlink
        vars: { target: 'wezterm' }

# zellij
  deploy:zellij:
    desc: Deploy zellij config.
    cmds:
      - task: link
        vars: { target: 'zellij' }

  clean:zellij:
    desc: Clean zellij config.
    cmds:
      - task: unlink
        vars: { target: 'zellij' }

# zsh
  deploy:zsh:
    desc: Deploy zsh config.
    cmds:
      - ln -svi $(pwd)/zsh/.zshenv $HOME/.zshenv
      - task: link
        vars: { target: 'zsh' }

  clean:zsh:
    desc: Clean zsh config.
    cmds:
      - unlink $HOME/.zshenv
      - task: unlink
        vars: { target: 'zsh' }

# Internal tasks
  link:
    internal: true
    requires:
      vars: [target]
    cmds:
      - ln -svi $(pwd)/{{.target}} {{.config_dir}}

  unlink:
    internal: true
    requires:
      vars: [target]
    cmds:
      - unlink {{.config_dir}}/{{.target}}
